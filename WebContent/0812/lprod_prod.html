<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<link rel="stylesheet" href="../css/myStyle.css">
<script src="../js/jquery-3.4.1.min.js"></script>

<script>
   $(function() {
      $('button').on('click', function () {
         
//          $.ajax({
//             url : 'jqpro/LprodSelect',
//             type : 'get',
//             dataType : 'json',
//             success : function (res) {
               
//             },
//             error : function (xhr) {
               
//             }
//          })

         // :) 단축메뉴는 순서가 바뀌면 안된다.
         $.getJSON(
            '/jqpro/LprodServlet',
            function (res) {
               code = "";
               $.each(res, function (i) {
                  code += "<option value='" + res[i].gu + "'>" + res[i].nm + "</option>"
               })
               
               $('#lprod').html(code);
            }
         )
         
      })
      
      $('#lprod').on('change', function () {
         
         // option의 value값을 가져온다.
         lprodGu = $(this).val();
         
         // 서버로 전송
         $.get(
            '/jqpro/ProdServlet',
            {'lprod_gu' : lprodGu},
            function (res) {
               code = "";
               $.each(res, function (i) {
                  code += "<option value='" + res[i].id + "'>" + res[i].name + "</option>"
               })
               
               $('#prod').html(code);
            },
            'json'
         )
         
         
         $('#prod').on('change', function(){
        	 prodId = $(this).val();
        	 
        	 //서버로 전송
        	 $.post(
        			 '/jqpro/ProdServlet',	
        			 {"prod_id" : prodId},
        			 function(res){
        				 code = "<table border ='1'>";
        				 code += "<tr><td>항목</td><td>내용</td></tr>";
        				 code += "<tr><td>PROD_ID</td><td>" + res.id + "</td>         </tr>";
        				 code += "<tr><td>PROD_NAME</td><td>" + res.name + "</td>     </tr>";
        				 code += "<tr><td>PROD_LGU</td><td>" + res.lgu + "</td>       </tr>";
        				 code += "<tr><td>PROD_SALE</td><td>" + res.sale + "</td>     </tr>";
        				 code += "<tr><td>PROD_PRICE</td><td>" + res.price + "</td>   </tr>";
        				 code += "<tr><td>PROD_DETAIL</td><td>" + res.detail + "</td> </tr>";
        				 code += "</table>";
        				 
        				$("#detail").html(code); 
        				 
        				 
        			 },
        	 		 'json'
        	 )
        	 
         })
         
         
         
      })
      
   })
</script>
<style>
   table{
      border-collapse: collapse;
   }
   td{
      width: 250px;
      height: 40px;
      text-align: center;
   }
</style>
</head>
<body>
   <button type="button">실행</button>
   <br><br>
   
   <table border="1">
      <tr>
         <td>
            <select name="lprod" id="lprod"></select>
         </td>
         <td>
            <select name="prod" id="prod"></select>
         </td>
      </tr>
      <tr>
         <td colspan="2">
            <div id="detail"></div>
         </td>
      </tr>   
   </table>
</body>
</html>